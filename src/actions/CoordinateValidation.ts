export type LatLngTuple = [number, number];

export const GERMANY_BBOX = {
  minLat: 47.2701,
  maxLat: 55.0992,
  minLng: 5.8663,
  maxLng: 15.0419,
};

export const GERMANY_POLYGON: LatLngTuple[] = [

  [54.87764, 8.429721],
  [54.916737, 8.812039],
  [54.855953, 9.224779],
  [54.802235, 9.282592],
  [54.841171, 9.40868],
  [54.788471, 9.435278],
  [54.875973, 9.613611],
  [54.831528, 9.603056],
  [54.756248, 9.843056],
  [54.68014, 10.955279],
  [54.502359, 11.534722],
  [54.872359, 12.934722],
  [54.872359, 14.284722],
  [53.73875, 14.283056],
  [53.702641, 14.215277],
  [53.699306, 14.273163],
  [53.618649, 14.324908],
  [53.54261, 14.302709],
  [53.261639, 14.44893],
  [53.204159, 14.378919],
  [53.052917, 14.345703],
  [52.961113, 14.142452],
  [52.840271, 14.12127],
  [52.580032, 14.639062],
  [52.533024, 14.600604],
  [52.49913, 14.631249],
  [52.396412, 14.528909],
  [52.289562, 14.5709],
  [52.241089, 14.699571],
  [52.121552, 14.669349],
  [52.073391, 14.741279],
  [51.942661, 14.704778],
  [51.823605, 14.586701],
  [51.66687, 14.738729],
  [51.55851, 14.698139],
  [51.482269, 14.933859],
  [51.354416, 14.967818],
  [51.309799, 15.02848],
  [50.991405, 14.930112],
  [50.828918, 14.805079],
  [50.826759, 14.710871],
  [50.854782, 14.611929],
  [50.93264, 14.651672],
  [50.923485, 14.560113],
  [50.98851, 14.595056],
  [51.051506, 14.50168],
  [51.008282, 14.39741],
  [51.054165, 14.294017],
  [50.973202, 14.246868],
  [50.942348, 14.400947],
  [50.88858, 14.372269],
  [50.803711, 13.95461],
  [50.718201, 13.850809],
  [50.713215, 13.548976],
  [50.596489, 13.465191],
  [50.643661, 13.37491],
  [50.581814, 13.326788],
  [50.59227, 13.248618],
  [50.500591, 13.195991],
  [50.508549, 13.033267],
  [50.414272, 12.977046],
  [50.458622, 12.82877],
  [50.397758, 12.705129],
  [50.400085, 12.516113],
  [50.276424, 12.364088],
  [50.179729, 12.32759],
  [50.182678, 12.282716],
  [50.322876, 12.194092],
  [50.255352, 12.08586],
  [50.195621, 12.198919],
  [50.11182, 12.19906],
  [50.062279, 12.25603],
  [49.927143, 12.547736],
  [49.790272, 12.472073],
  [49.755161, 12.40289],
  [49.687759, 12.52786],
  [49.543999, 12.588052],
  [49.531059, 12.64583],
  [49.432167, 12.661075],
  [49.351906, 12.784105],
  [49.30864, 13.033589],
  [49.14444, 13.18021],
  [49.051781, 13.403729],
  [48.983913, 13.401621],
  [48.950581, 13.63126],
  [48.775051, 13.835958],
  [48.721512, 13.787059],
  [48.590904, 13.809944],
  [48.516792, 13.721092],
  [48.596512, 13.503159],
  [48.564682, 13.435749],
  [48.377739, 13.410619],
  [48.305172, 13.28572],
  [48.203667, 12.868215],
  [48.11729, 12.753029],
  [47.85223, 13.001147],
  [47.731243, 12.911267],
  [47.720989, 13.043539],
  [47.639202, 13.105589],
  [47.465767, 13.013464],
  [47.561462, 12.799818],
  [47.616261, 12.826677],
  [47.675922, 12.782772],
  [47.679249, 12.605334],
  [47.628853, 12.506064],
  [47.700733, 12.435963],
  [47.67622, 12.25878],
  [47.73999, 12.254279],
  [47.698875, 12.174352],
  [47.6012, 12.20928],
  [47.59827, 11.636344],
  [47.511822, 11.58102],
  [47.51326, 11.43738],
  [47.471924, 11.388032],
  [47.445621, 11.424081],
  [47.451824, 11.341606],
  [47.39101, 11.2739],
  [47.39127, 11.224139],
  [47.43478, 11.246058],
  [47.396111, 10.977521],
  [47.478081, 10.926509],
  [47.478031, 10.862999],
  [47.516094, 10.918594],
  [47.538105, 10.883133],
  [47.516144, 10.772025],
  [47.57365, 10.60006],
  [47.535931, 10.561381],
  [47.58556, 10.432245],
  [47.433064, 10.471569],
  [47.378719, 10.43358],
  [47.269901, 10.170169],
  [47.392918, 10.22687],
  [47.35487, 10.095961],
  [47.456593, 10.090755],
  [47.486225, 9.997338],
  [47.550484, 9.971187],
  [47.53072, 9.87367],
  [47.596802, 9.774219],
  [47.543983, 9.688732],
  [47.823689, 9.044015],
  [47.668152, 9.22114],
  [47.653584, 9.164095],
  [47.747986, 8.99164],
  [47.731823, 8.941365],
  [47.695091, 9.00637],
  [47.655224, 8.891834],
  [47.74168, 8.808216],
  [47.719769, 8.771158],
  [47.679909, 8.798148],
  [47.696842, 8.72789],
  [47.766109, 8.730446],
  [47.814377, 8.567991],
  [47.68005, 8.404398],
  [47.643356, 8.473679],
  [47.675995, 8.607149],
  [47.600311, 8.584686],
  [47.638096, 8.520914],
  [47.605957, 8.458549],
  [47.581394, 8.488503],
  [47.570251, 8.37954],
  [47.626156, 8.202873],
  [47.562885, 8.087834],
  [47.549702, 7.944072],
  [47.5947, 7.820772],
  [47.537117, 7.669493],
  [47.562424, 7.632384],
  [47.593262, 7.670561],
  [47.580959, 7.607771],
  [47.696091, 7.512127],
  [47.97366, 7.622157],
  [48.036339, 7.56859],
  [48.121391, 7.577859],
  [48.329826, 7.745232],
  [48.398685, 7.733547],
  [48.633675, 7.835923],
  [48.802013, 8.087015],
  [48.970631, 8.228879],
  [49.056232, 7.93704],
  [49.054169, 7.635286],
  [49.184025, 7.445586],
  [49.115158, 7.2934],
  [49.154331, 7.098151],
  [49.112587, 7.058024],
  [49.188263, 7.033706],
  [49.223076, 6.924295],
  [49.214233, 6.840444],
  [49.151379, 6.834463],
  [49.16457, 6.737988],
  [49.434162, 6.535419],
  [49.464985, 6.354821],
  [49.574047, 6.363648],
  [49.724178, 6.516485],
  [49.808571, 6.528252],
  [49.835499, 6.312281],
  [50.05991, 6.09837],
  [50.189465, 6.189638],
  [50.236256, 6.170382],
  [50.333069, 6.40834],
  [50.379894, 6.339758],
  [50.44595, 6.374672],
  [50.493645, 6.330028],
  [50.550514, 6.172194],
  [50.616398, 6.278379],
  [50.621433, 6.173087],
  [50.708736, 6.118732],
  [50.795052, 5.963199],
  [50.846859, 6.07384],
  [50.921799, 6.08294],
  [50.933159, 6.01517],
  [50.983364, 6.030001],
  [50.978271, 5.903691],
  [51.043411, 5.872059],
  [51.03447, 5.969544],
  [51.152931, 6.171799],
  [51.173717, 6.14478],
  [51.191662, 6.193139],
  [51.175293, 6.091834],
  [51.244713, 6.078186],
  [51.365982, 6.231969],
  [51.509171, 6.220356],
  [51.605221, 6.090958],
  [51.660458, 6.118769],
  [51.741611, 5.964008],
  [51.768169, 6.004778],
  [51.824409, 5.964649],
  [51.845032, 6.168982],
  [51.888988, 6.107149],
  [51.905384, 6.15889],
  [51.825634, 6.417467],
  [51.874802, 6.4023],
  [51.899052, 6.742709],
  [51.995529, 6.835361],
  [52.040119, 6.698179],
  [52.073792, 6.700689],
  [52.239254, 7.069309],
  [52.294319, 7.029719],
  [52.382725, 7.079116],
  [52.469501, 7.00628],
  [52.43697, 6.950539],
  [52.464931, 6.764862],
  [52.556065, 6.683791],
  [52.565166, 6.768261],
  [52.590611, 6.724298],
  [52.647091, 6.74381],
  [52.635849, 7.05186],
  [52.846451, 7.094277],
  [52.99754, 7.261488],
  [53.124462, 7.226969],
  [53.19957, 7.28456],
  [53.238808, 7.205278],
  [53.329861, 7.249167],
  [53.361252, 6.998611],
  [53.583195, 6.564167],
  [55.003195, 6.564167],
  [55.046527, 8.360277],
];

export function pointInPolygon(lat: number, lng: number, polygon: LatLngTuple[]): boolean {
  let inside = false;
  for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {
    const xi = polygon[i][0], yi = polygon[i][1];
    const xj = polygon[j][0], yj = polygon[j][1];
    const intersect = ((yi > lng) !== (yj > lng)) &&
      (lat < (xj - xi) * (lng - yi) / (yj - yi + 1e-12) + xi);
    if (intersect) inside = !inside;
  }
  return inside;
}

export function isInGermany(lat: number, lng: number): boolean {
  if (lat < GERMANY_BBOX.minLat || lat > GERMANY_BBOX.maxLat || lng < GERMANY_BBOX.minLng || lng > GERMANY_BBOX.maxLng) {
    return false;
  }
  return pointInPolygon(lat, lng, GERMANY_POLYGON);
}
